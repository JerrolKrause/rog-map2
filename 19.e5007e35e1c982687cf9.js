(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"6GuE":function(t,e,o){"use strict";o.r(e),o.d(e,"MapMapboxModuleNgFactory",function(){return r});var a=o("CcnG"),i=o("vzWj"),n=o("Ip0R"),s=o("CE6+"),r=a["\u0275cmf"](i.a,[],function(t){return a["\u0275mod"]([a["\u0275mpd"](512,a.ComponentFactoryResolver,a["\u0275CodegenComponentFactoryResolver"],[[8,[]],[3,a.ComponentFactoryResolver],a.NgModuleRef]),a["\u0275mpd"](4608,n.p,n.o,[a.LOCALE_ID,[2,n.B]]),a["\u0275mpd"](4608,s.a,s.a,[]),a["\u0275mpd"](1073742336,n.c,n.c,[]),a["\u0275mpd"](1073742336,i.a,i.a,[])])})},"CE6+":function(t,e,o){"use strict";o.d(e,"a",function(){return i});var a=function(){return(a=Object.assign||function(t){for(var e,o=1,a=arguments.length;o<a;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=function(){function t(){}return t.prototype.markersAdd=function(t,e){t&&e&&e.length&&e.forEach(function(e){return e.addTo(t)})},t.prototype.heatMapAdd=function(t,e){var o=e.map(function(t){return{type:"Feature",geometry:{type:"Point",coordinates:[t.longitude,t.latitude]}}});t.addSource("heatmap",{type:"geojson",data:{type:"FeatureCollection",crs:{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},features:o}}),t.addLayer({id:"heatmap",type:"heatmap",source:"heatmap",paint:{"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",1,"rgb(178,24,43)"],"heatmap-weight":["interpolate",["exponential",1.5],["zoom"],0,["interpolate",["linear"],["get","density"],0,0,25,1],18.1,["interpolate",["linear"],["get","density"],0,0,15,1]],"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,9,20],"heatmap-intensity":["interpolate",["linear"],["zoom"],0,.25,.99,1,1,.25,1.99,1,2,.25,2.99,1,3,.25,3.99,1,4,.25,4.99,1,5,.25,5.99,1,6,.25,6.99,1,7,.25,7.99,1,8,.25,8.99,1,9,.25,9.99,1,10,.25,10.99,1,11,.25,11.99,1,12,.25,18.99,2],"heatmap-opacity":["interpolate",["exponential",1.5],["zoom"],16,1,18.1,.6]}},"water")},t.prototype.heatMapRemove=function(t){t&&void 0!==t.getLayer("heatmap")&&(t.removeLayer("heatmap"),t.removeSource("heatmap"))},t.prototype.mapFitBounds=function(t,e){t&&e&&e.length&&setTimeout(function(){t.rotateTo(0,{duration:500}),setTimeout(function(){var o=new window.mapboxgl.LngLatBounds;e.forEach(function(t){o.extend(t.getLngLat())}),t.fitBounds(o)},500)},100)},t.prototype.flyToLocation=function(t,e,o){setTimeout(function(){t.rotateTo(0,{duration:500}),setTimeout(function(){t.flyTo(a({center:e,zoom:10,pitch:0,speed:2.2,curve:1.42,easing:function(t){return t}},o))},500)},100)},t.prototype.markersCreate=function(t){return t.map(function(t){if(t.latitude&&t.longitude){var e=document.createElement("div");e.className=t.metadata&&t.metadata.iconClass?t.metadata.iconClass:"marker";var o=new window.mapboxgl.Marker(e).setLngLat([t.longitude,t.latitude]);return o.location=a({},t),o}})},t.prototype.createPopup=function(t,e){var o="";e.metadata&&e.metadata.title&&(o+="<h3>"+e.metadata.title+"</h3>"),e.metadata&&e.metadata.description&&(o+="<div>"+e.metadata.description+"</div>"),t.setPopup(new window.mapboxgl.Popup({offset:25}).setHTML(o))},t}()},ygIs:function(t,e,o){"use strict";o.d(e,"a",function(){return n});var a=o("CcnG"),i=(o("CE6+"),"pk.eyJ1Ijoicm9ndXNlciIsImEiOiJjanB1YzFrMmwwZjZnNDNxbGkwY28wdnI5In0.Xe4QgRnvsvP3WAncobSxqg"),n=function(){function t(t){var e=this;this.mapObjects=t,this.apiKey=i,this.zoom=15.5,this.style="streets",this.heatmap=!1,this.pinClicked=new a.EventEmitter,this.isLoaded=!1,this.uniqueId="map-box"+Math.floor(1e6*Math.random()),this.isRotating=!0,this.rotateTo=function(t){e.map.rotateTo(t/300%360,{duration:0}),e.isRotating&&requestAnimationFrame(e.rotateTo)}}return t.prototype.ngOnInit=function(){},t.prototype.ngOnChanges=function(t){t.style&&this.isLoaded&&this.map.setStyle("mapbox://styles/mapbox/"+this.style+"-v9"),t.locations&&this.isLoaded&&(this.heatmap?this.heatMapAdd():(this.isRotating=!1,this.locationsAdd())),t.heatmap&&this.isLoaded&&(this.heatmap?this.heatMapAdd():(this.heatMapRemove(),this.locations&&this.locationsAdd())),t.flyTo&&this.isLoaded&&(this.isRotating=!1,this.mapObjects.flyToLocation(this.map,this.flyTo.coords,{zoom:15,speed:3}))},t.prototype.ngAfterViewInit=function(){this.scriptsLoad()},t.prototype.scriptsLoad=function(){var t=this;if(window.mapboxgl)this.mapInit(),this.isLoaded=!0;else{var e=document.createElement("script");e.type="text/javascript",e.src="https://api.mapbox.com/mapbox-gl-js/v0.52.0/mapbox-gl.js",e.onload=function(){t.mapInit()},document.head.appendChild(e)}},t.prototype.mapInit=function(){var t=this;!this.map&&document.getElementById(this.uniqueId)&&(window.mapboxgl.accessToken=this.apiKey,navigator.geolocation.getCurrentPosition(function(e){t.mapCreate([e.coords.longitude,e.coords.latitude])},function(e){console.log(e),t.mapCreate([-115.172813,36.114647])}))},t.prototype.mapCreate=function(t){var e=this;this.map=new window.mapboxgl.Map({container:this.uniqueId,style:"mapbox://styles/mapbox/"+this.style+"-v9",zoom:this.zoom,center:[-115.156665,36.1383415],pitch:60}),this.map.once("click",function(){e.isRotating=!1,setTimeout(function(){e.mapObjects.mapFitBounds(e.map,e.markers)},100)}),this.map.on("load",function(){e.rotateTo(0),e.heatmap&&e.locations&&e.mapObjects.heatMapAdd(e.map,e.locations),e.heatmap||e.locationsAdd(!1),e.locations||(e.locations=[{latitude:t[1],longitude:t[0]}],e.locationsAdd(!1)),e.map.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.6}}),e.isLoaded=!0})},t.prototype.heatMapAdd=function(){this.locationsRemove(),this.heatMapRemove(),this.mapObjects.heatMapAdd(this.map,this.locations),this.markers=this.mapObjects.markersCreate(this.locations),this.mapObjects.mapFitBounds(this.map,this.markers)},t.prototype.heatMapRemove=function(){this.mapObjects.heatMapRemove(this.map)},t.prototype.locationsAdd=function(t){var e=this;void 0===t&&(t=!0),this.locations&&this.locations.length?(this.locationsRemove(),this.markers=this.mapObjects.markersCreate(this.locations),this.markers.forEach(function(t){t.getElement().addEventListener("click",function(o){e.isRotating=!1,e.pinClicked.emit(t.location),o.stopPropagation()})}),this.mapObjects.markersAdd(this.map,this.markers),t&&this.mapObjects.mapFitBounds(this.map,this.markers)):this.locationsRemove()},t.prototype.locationsRemove=function(){this.markers&&this.markers.length&&this.markers.forEach(function(t){return t.remove()})},t}()}}]);